#include "HOGDetector.hpp"

HOGDetector::HOGDetector(){}

HOGDetector::HOGDetector(DetectorType type)
{
	blockSize = cv::Size(16, 16);
	blockStride = cv::Size(8, 8);
	cellSize = cv::Size(8, 8);
	nbins = 9;
	derivAperture = 1;
	winSigma = -1;
	histogramNormType = HOGDescriptor::L2Hys;
	L2HysThreshold = 0.2;
	gammaCorrection = true;
	nlevels = 20;

	switch(type)
	{
		case TORSO:
		{
			winSize = cv::Size(48, 64);
			searchRoiRatio = 2;

			float model[] =
			{
				-0.0331521,
				-0.401166,
				-0.381963,
				-0.255931,
				0.16367,
				-0.0526464,
				-0.0510699,
				-0.210932,
				0.10969,
				0.514686,
				0.0518859,
				-0.280271,
				-0.0741454,
				0.0737474,
				0.00849345,
				-0.172531,
				0.337791,
				0.0850884,
				0.10563,
				-0.057375,
				0.411323,
				0.538001,
				-0.0427591,
				0.531964,
				-0.0350484,
				0.0288925,
				0.0403985,
				-0.125518,
				0.277431,
				-0.0946664,
				0.148171,
				-0.173083,
				-0.0842567,
				0.135501,
				-0.297637,
				0.13954,
				-0.493424,
				0.171075,
				-0.00869676,
				-0.0773082,
				0.287454,
				0.187761,
				0.488714,
				-0.71411,
				0.411124,
				0.030106,
				-0.542983,
				0.127117,
				0.103989,
				-0.0333934,
				0.223697,
				-0.338198,
				0.448787,
				0.390182,
				0.21038,
				-0.413683,
				-0.0749184,
				0.393329,
				0.0875081,
				0.0246735,
				-0.220256,
				0.277561,
				0.106186,
				0.00828417,
				-0.201273,
				0.0992567,
				0.0697028,
				-0.0979374,
				0.0926141,
				-0.042511,
				-0.138201,
				-0.345564,
				-0.015372,
				0.237226,
				-0.385808,
				-0.0523386,
				-0.237216,
				0.161412,
				-0.25095,
				0.0360766,
				-0.322962,
				-0.171969,
				-0.191872,
				-0.530659,
				0.122744,
				0.192794,
				-0.139182,
				0.0238073,
				-0.24982,
				-0.00757278,
				0.0894765,
				0.226262,
				-0.10226,
				0.101607,
				-0.0493601,
				-0.38416,
				0.140961,
				0.104655,
				0.318402,
				-0.364569,
				-0.335215,
				0.7418,
				0.187522,
				-0.0967173,
				-0.230231,
				0.278027,
				-0.160327,
				0.121297,
				0.475179,
				0.695068,
				0.233969,
				-0.257167,
				0.317121,
				-0.0451324,
				0.044302,
				0.310057,
				0.140737,
				-0.211632,
				0.117247,
				-0.735169,
				0.0494764,
				-0.0375959,
				0.258852,
				0.0507616,
				-0.366149,
				-0.289067,
				-0.10706,
				0.840479,
				-0.701699,
				-0.160762,
				-0.249958,
				0.61193,
				-0.287573,
				0.101769,
				-0.0859478,
				0.422252,
				0.759726,
				-0.657793,
				0.263414,
				-0.111311,
				-0.348925,
				0.0168608,
				-0.467101,
				-0.123214,
				0.243989,
				0.0998734,
				-0.187426,
				0.0618876,
				0.155351,
				0.291297,
				-0.295758,
				0.243609,
				0.0603516,
				0.712052,
				0.171313,
				-0.0195565,
				-0.148595,
				0.531664,
				-0.268748,
				-0.206052,
				-0.132549,
				0.0387472,
				0.259693,
				-0.184084,
				0.111544,
				-0.10923,
				0.00272933,
				0.00398409,
				0.141145,
				0.762624,
				-0.440318,
				-0.308683,
				0.182505,
				-0.229632,
				0.0772174,
				-0.605352,
				0.364404,
				-0.435638,
				-0.0584998,
				-0.0764658,
				-0.409271,
				0.170729,
				-0.142345,
				0.36608,
				0.100471,
				-0.0383826,
				-0.322612,
				0.638621,
				-0.019403,
				0.334362,
				0.00551502,
				-0.166023,
				0.0578669,
				0.0826254,
				0.216836,
				-0.102291,
				0.146181,
				-0.0836619,
				0.211285,
				-0.217749,
				-0.173997,
				0.112372,
				0.427556,
				0.199288,
				0.56676,
				-0.0634953,
				-0.147696,
				0.327414,
				0.080315,
				0.345618,
				0.116402,
				-0.341439,
				-0.102738,
				-0.54671,
				-0.0050642,
				-0.106604,
				0.0321215,
				-0.0782339,
				-0.317622,
				-0.0169569,
				-0.111573,
				0.065087,
				-0.251127,
				0.207009,
				-0.254534,
				-0.352433,
				-0.0365224,
				-0.00381133,
				0.195271,
				0.0863595,
				-0.164375,
				-0.0258741,
				-0.24567,
				0.065539,
				-0.588139,
				0.0190904,
				-0.205253,
				-0.239362,
				0.581343,
				-0.267444,
				0.27302,
				0.150564,
				0.227694,
				0.485019,
				0.116594,
				-0.305149,
				-0.608269,
				-0.2086,
				0.101229,
				-0.0215959,
				-0.0261245,
				0.281804,
				-0.0938729,
				-0.605388,
				-0.333545,
				-0.498601,
				0.37387,
				-0.76962,
				-0.168936,
				-0.491901,
				0.309168,
				0.67389,
				-0.180053,
				0.181556,
				-0.322148,
				0.379108,
				0.432962,
				0.526298,
				0.0875643,
				-0.409884,
				-0.139157,
				0.147157,
				0.279818,
				0.618974,
				-0.109496,
				-0.0254253,
				0.00979412,
				-0.382635,
				0.551343,
				0.515552,
				0.437391,
				0.500239,
				0.201767,
				0.300185,
				-0.641474,
				-0.205283,
				-0.214392,
				-0.0965436,
				0.00895222,
				0.684309,
				0.329153,
				-0.375759,
				0.099224,
				-0.193834,
				-0.584844,
				0.00725576,
				0.56689,
				0.397146,
				-0.467757,
				0.0710453,
				-0.148257,
				0.185622,
				0.123539,
				0.247899,
				0.81977,
				0.185821,
				0.635438,
				-0.133925,
				-0.157651,
				-0.0621182,
				0.308571,
				0.358526,
				0.23778,
				0.462617,
				0.220538,
				-0.166942,
				0.427249,
				-0.125132,
				0.813815,
				0.188364,
				-0.228354,
				-0.02203,
				0.212453,
				0.575344,
				-0.451893,
				0.408582,
				0.107275,
				0.760079,
				0.341669,
				-0.0357544,
				0.289072,
				-0.0916931,
				-0.102152,
				0.187869,
				0.0474048,
				0.731918,
				0.131864,
				-0.0050132,
				0.0581587,
				-0.41901,
				-0.30495,
				-0.00787421,
				0.603715,
				0.29911,
				0.405057,
				0.175794,
				-0.175563,
				0.03507,
				0.880539,
				0.311342,
				0.224171,
				-0.0739747,
				-0.308249,
				0.211406,
				0.399135,
				-0.437735,
				0.00704374,
				-0.256958,
				-0.374773,
				0.387042,
				0.0437312,
				0.046506,
				0.475094,
				0.291209,
				-0.275142,
				-0.47723,
				0.278547,
				0.367447,
				-0.6399,
				-0.230967,
				-0.0569401,
				-0.567672,
				0.0272994,
				-0.0629075,
				0.0754902,
				0.135869,
				-0.013893,
				0.111935,
				-0.350772,
				0.249619,
				-0.348136,
				-0.0634268,
				0.103562,
				0.0561392,
				-0.149665,
				0.204885,
				-0.36392,
				0.0785339,
				-0.782431,
				-0.0041047,
				-0.680238,
				0.346609,
				-0.385727,
				-0.0828294,
				0.074223,
				-0.0794707,
				-0.450792,
				0.138532,
				-0.0730529,
				-0.137288,
				-0.179343,
				0.311213,
				-0.217175,
				0.286422,
				-0.00424165,
				0.320768,
				0.380142,
				0.114347,
				0.308398,
				0.21152,
				-0.240525,
				0.300054,
				-0.213102,
				0.308506,
				0.199812,
				0.527772,
				0.377941,
				0.784305,
				-0.22997,
				-0.044504,
				-0.332733,
				-0.224362,
				0.0373668,
				-0.403235,
				-0.416081,
				-0.755234,
				-0.486574,
				-0.531766,
				0.111924,
				-0.010928,
				0.320943,
				0.393454,
				0.100527,
				0.28258,
				0.104222,
				-0.491455,
				-0.345075,
				0.141291,
				-0.136749,
				0.209883,
				0.0814258,
				0.0983281,
				0.170408,
				-0.218226,
				0.244786,
				-0.0294751,
				0.079363,
				0.322323,
				0.325073,
				-0.326875,
				-0.00598788,
				0.0759974,
				0.158581,
				0.32685,
				0.413337,
				0.0265839,
				-0.323061,
				-0.728335,
				0.00636666,
				0.232593,
				0.0760789,
				-0.483549,
				-0.347903,
				0.0549203,
				-0.145075,
				-0.43797,
				0.567955,
				0.362336,
				0.0640042,
				0.413888,
				0.33421,
				0.581858,
				-0.557164,
				-0.012336,
				0.167975,
				-0.450152,
				0.0820682,
				0.566748,
				0.180745,
				-0.362306,
				0.594876,
				-0.272027,
				0.0739185,
				0.102119,
				0.299148,
				-0.0984411,
				0.340461,
				-0.412871,
				0.171417,
				-0.211556,
				0.566225,
				0.158256,
				-0.0152618,
				0.153013,
				-0.29087,
				-0.610762,
				0.744192,
				-0.645711,
				-0.325654,
				-0.101275,
				-0.0199515,
				-0.516208,
				0.0344796,
				-0.183555,
				0.266947,
				-0.847088,
				0.232887,
				0.63388,
				0.147969,
				0.437235,
				-0.216478,
				-0.260268,
				-0.201505,
				-0.369034,
				0.491119,
				0.100518,
				-0.262358,
				-0.56041,
				0.370341,
				0.263051,
				0.353812,
				-0.976157,
				0.0143905,
				0.0570589,
				-0.0806795,
				0.588307,
				-0.486585,
				0.289025,
				0.178851,
				-0.470144,
				0.280108,
				-0.488216,
				-0.407351,
				0.678779,
				0.424049,
				0.392758,
				-0.0561064,
				0.564285,
				0.218284,
				-0.395857,
				0.501333,
				-0.178861,
				-0.382254,
				0.687071,
				-0.345055,
				0.471497,
				-0.394573,
				-0.0667759,
				0.04373,
				-0.224122,
				-0.480069,
				-0.0934816,
				-0.199053,
				-0.778018,
				-0.0137494,
				0.292658,
				0.791709,
				-0.131666,
				-0.018205,
				0.571127,
				-0.511571,
				-0.196045,
				-0.352175,
				0.129818,
				-0.702046,
				0.154191,
				0.416411,
				-0.114174,
				0.0253783,
				0.255626,
				0.0754074,
				-0.225943,
				-0.0961198,
				-0.183717,
				-0.354141,
				-0.0628765,
				-0.439602,
				0.691501,
				0.174409,
				0.262051,
				0.44755,
				-0.149476,
				-0.560188,
				-0.49273,
				-0.178501,
				-0.654264,
				-0.0581118,
				0.0433362,
				-0.410981,
				0.284917,
				0.249935,
				0.508993,
				0.533243,
				0.500718,
				-0.217408,
				-0.266986,
				-0.329586,
				0.0858303,
				-0.212782,
				-0.269071,
				0.561346,
				0.0488642,
				0.096834,
				0.381059,
				0.00404245,
				0.120833,
				0.176641,
				0.326027,
				0.158405,
				-0.0124113,
				-0.0701818,
				-0.626003,
				0.0182045,
				-0.169006,
				0.301539,
				-0.167458,
				-0.550133,
				0.254052,
				-0.0129043,
				-0.00169195,
				-0.17767,
				0.101918,
				0.312346,
				-0.278657,
				-0.0697797,
				-0.212703,
				0.291156,
				-0.0273306,
				-0.524754,
				-0.088493,
				-0.194194,
				-0.118323,
				0.124011,
				0.262163,
				-0.104883,
				0.0392031,
				0.012439,
				-0.300823,
				-0.396191,
				-0.0584919,
				-0.118143,
				0.101023,
				0.034431,
				-0.300339,
				0.0924057,
				-0.00378902,
				0.252881,
				0.278443,
				-0.312215,
				-0.161156,
				-0.324965,
				-0.340064,
				-0.303161,
				0.0766379,
				0.486895,
				0.259449,
				-0.131859,
				-0.0771902,
				0.237433,
				0.103761,
				0.28131,
				0.386995,
				0.131215,
				-0.111807,
				-0.372523,
				0.252995,
				-0.0578742,
				-0.0756608,
				0.197355,
				0.245858,
				0.0551293,
				-0.339744,
				-0.36151,
				-0.00760354,
				-0.205663,
				0.0651363,
				0.114155,
				-0.486781,
				0.130037,
				-0.178593,
				0.256209,
				-0.0801523,
				-0.0219023,
				-0.105642,
				0.217553,
				0.0905296,
				0.286675,
				-0.699549,
				-0.136988,
				0.296842,
				-0.221482,
				0.659399,
				-0.415465,
				-0.134594,
				-0.543801,
				0.469673,
				0.226637,
				-0.337489,
				-0.149045,
				0.36837,
				-0.343298,
				-0.378532,
				-0.0345712,
				0.260494,
				0.0354803,
				0.195904,
				-0.419672,
				-0.819124,
				-0.00883715,
				0.32436,
				0.218084,
				-0.413409,
				-0.65243,
				0.633955,
				-0.300006,
				-0.00491759,
				0.251352,
				0.302924,
				-0.314243,
				-0.127194,
				-0.237176,
				0.286843,
				-0.317515,
				-0.0695945,
				-0.391588,
				0.673402,
				-0.444053,
				-0.291661,
				0.267206,
				-0.24041,
				-0.404831,
				0.392992,
				0.216171,
				0.0901208,
				0.1858,
				0.216308,
				0.00128423,
				-0.193629,
				0.36993,
				-0.116983,
				-0.368645,
				0.0301217,
				-0.0315909,
				-0.292476,
				-0.00359498,
				0.316568,
				-0.43133,
				-0.363748,
				0.198487,
				0.151778,
				-0.174261,
				0.251131,
				-0.231,
				0.460066,
				-0.212175,
				-0.0474588,
				0.290723,
				-0.346518,
				0.0928944,
				-0.272197,
				0.190815,
				0.381972,
				0.498314,
				-0.270946,
				0.228209,
				-0.137396,
				-0.0889457,
				-0.185523,
				-0.667861,
				-0.0158015,
				0.247072,
				0.38165,
				0.789557,
				0.511229,
				0.189487,
				-0.369319,
				-0.266881,
				-0.186285,
				0.307306,
				0.0389743,
				-0.118033,
				-0.393031,
				-0.0742181,
				0.00301091,
				-0.0368236,
				0.394687,
				0.643951,
				0.264124,
				-0.130111,
				-0.0456083,
				-0.166589,
				0.442407,
				0.202435,
				0.0898064,
				-0.134551,
				0.343085,
				0.411324,
				0.175155,
				-0.55938,
				-0.0270126,
				0.442884,
				0.43517,
				1.25358,
				0.272285,
				-0.470266,
				0.284501,
				0.423697,
				0.566266,
				0.232678,
				-0.412246,
				0.472243,
				-0.344306,
				-0.0539115,
				0.253629,
				-0.56835,
				0.013554,
				0.65312,
				0.1524,
				-0.0284371,
				0.642393,
				0.124661,
				0.214361,
				-0.336384,
				0.172787,
				-0.311779,
				-0.372807,
				-0.211327,
				0.303078,
				0.0116041,
				0.236747,
				-0.101051,
				0.510494,
				-0.249948,
				0.702905,
				0.1761,
				0.436636,
				0.0352387,
				0.369961,
				0.212772,
				0.43952,
				-0.427914,
				-0.644744,
				-0.100381,
				0.273072,
				-0.133273,
				0.0675584,
				0.00652188,
				-0.0353084,
				0.13592,
				0.277981,
				0.215481,
				0.900943,
				0.116463,
				0.660382,
				-0.116511,
				-0.00273775,
				-0.0484162,
				-0.240418,
				-0.1996,
				0.624564,
				0.276487,
				0.486314,
				-0.484854,
				0.410151,
				-0.129315,
				0.0675741,
				0.285329,
				-0.0951984,
				-0.104778,
				-0.168905,
				-0.406535,
				0.46048,
				-0.234515,
				-0.207567,
				0.0550699,
				-0.496934,
				-0.286234,
				-0.0502401,
				-0.712643,
				-0.306334,
				-0.762693,
				-0.349198,
				-0.500933,
				-0.179903,
				-0.275881,
				-0.184667,
				-0.251778,
				0.169521,
				0.449928,
				0.308988,
				-0.334559,
				-0.28519,
				0.0336624,
				0.415567,
				-0.218646,
				0.0207302,
				-0.411413,
				-0.394468,
				-0.0657476,
				0.104394,
				-0.286922,
				0.162082,
				-0.0786242,
				0.0348305,
				-0.532666,
				0.851323,
				0.322678,
				0.122319,
				0.361471,
				0.49019,
				-0.119357,
				0.0864943,
				-0.0707603,
				-0.076749,
				-0.102623,
				-0.174845,
				0.0430572,
				-0.326056,
				0.373166,
				0.2475,
				-0.00927877,
				0.0476121,
				-0.0517536,
				0.184884,
				-0.193394,
				0.268377,
				-0.304998,
				0.267364,
				-0.074644,
				0.049194,
				-0.171554,
				0.0153373,
				-0.541611,
				-0.00896016,
				0.0291462,
				0.267048,
				-0.098231,
				-0.269059,
				-0.462964,
				0.037207,
				0.443793,
				0.103026,
				-0.205418,
				-0.378992,
				0.182894,
				0.0342111,
				0.461823,
				-0.45737,
				0.0187929,
				-0.13334,
				-0.116892,
				-0.246978,
				-0.197103,
				-0.232735,
				0.174186,
				0.256207,
				0.106205,
				0.0588875,
				-0.190363,
				0.323178,
				0.300009,
				0.4899,
				-0.412596,
				-0.469706,
				0.0666598,
				0.349327,
				-0.0388524,
				-0.0395135,
				-0.034684,
				-0.203648,
				0.0804952,
				0.224881,
				-0.198857,
				-0.0213095,
				-0.00890925,
				-0.0498833,
				0.313015,
				0.0790033,
				-0.182982,
				-0.242736,
				0.808215,
				-0.571103,
				0.0382642,
				-0.188171,
				0.305604,
				-0.103916,
				-0.123727,
				-0.617956,
				0.15828,
				-0.439366,
				0.463843,
				-0.510409,
				-0.179999,
				0.287003,
				-0.300674,
				0.386615,
				0.171829,
				0.516571,
				-0.52399,
				0.0594119,
				0.620778,
				-0.338853,
				-0.263861,
				-0.0149902,
				-0.0714288,
				0.0490604,
				-0.0746129,
				0.43973,
				0.392751,
				-0.283418,
				-0.244325,
				-0.100411,
				0.13308,
				-0.130349,
				0.555354,
				-0.0333889,
				0.160205,
				-0.12786,
				0.156076,
				-0.206453,
				0.136414,
				-0.0727923,
				0.438764,
				-0.156818,
				0.484597,
				-0.274089,
				0.102567,
				-0.482939,
				0.000547528,
				0.116833,
				0.210348,
				0.261663,
				-0.495468,
				-0.215349,
				0.414245,
				0.291793,
				0.169162,
				-0.0298148,
				0.577416,
				-0.473142,
				-0.107468,
				0.125618,
				-0.00426582,
				0.144411,
				0.213263,
				-0.00839302,
				-0.139108,
				-0.00780156,
				0.384556,
				-0.0852312,
				-0.0557734,
				0.0464984,
				0.364822,
				-0.539562,
				0.278333,
				0.124165,
				-0.236886,
				-0.216964,
				0.189341,
				0.164562,
				-0.519039,
				-0.278956,
				0.233962,
				-0.441797,
				-0.306584,
				0.0620301,
				0.4082,
				-0.230626,
				-0.276247,
				-0.252004,
				-0.0837387,
				0.538498,
				-0.0816485,
				0.05725,
				0.452307,
				-0.122617,
				0.344796,
				-0.0972334,
				0.172331,
				-0.181113,
				0.173609,
				0.348509,
				-0.129637,
				-0.139554,
				-0.13178,
				0.125728,
				0.0231804,
				0.116027,
				0.325317,
				0.0613141,
				0.258173,
				0.0736843,
				-0.21154,
				0.213283,
				0.194241,
				0.843926,
				0.256715,
				-0.50536,
				-0.348496,
				0.175781,
				-0.429242,
				-0.0167294,
				0.339725,
				-0.172286,
				-0.156227,
				-0.0252818,
				-0.109792,
				0.219652,
				-0.388951,
				0.402409,
				-0.152803,
				-0.241622,
				-0.119692,
				-0.121233,
				-0.329043,
				0.0222244,
				-0.423052,
				0.223368,
				-0.309521,
				0.398166,
				-0.808836,
				0.124039,
				-0.979534,
				0.471569,
				0.203284,
				-0.43069,
				-0.472049,
				0.0330907,
				-0.404394,
				-0.00960492,
				0.267552,
				-0.75288,
				0.195181,
				0.38169,
				0.104319,
				0.414696,
				-0.281865,
				0.268205,
				0.321191,
				-0.297925,
				-0.0529953,
				0.700375,
				-0.0196559,
				-0.223026,
				-0.0652233,
				0.0342245,
				0.0566114,
				-0.00173374,
				0.362933,
				-0.0130612,
				0.204171,
				-0.156355,
				-0.216491,
				0.0767014,
				0.304896,
				0.0955582,
				-0.0172409,
				-0.140493,
				0.172075,
				-0.107546,
				-0.310621,
				0.0898536,
				-0.395686,
				0.0384277,
				-0.0095544,
				-0.340932,
				0.508102,
				-0.00659612,
				0.0756419,
				0.32037,
				0.420096,
				0.313702,
				-0.222222,
				-0.0230991,
				-0.064313,
				-0.141159,
				-0.640027,
				-0.0133418,
				0.499951,
				0.0239671,
				-0.179025,
				-0.395098,
				0.257033,
				0.515051,
				0.175911,
				0.0489097,
				0.379271,
				-0.123689,
				-0.0427607,
				0.161163,
				-0.051626,
				0.447651,
				-0.0109773,
				0.0938746,
				-0.705819,
				-0.064461,
				0.145168,
				-0.0371575,
				0.0147241,
				-0.182554,
				0.141463,
				-0.124522,
				-0.211356,
				0.457068,
				0.124907,
				0.331079,
				-0.139442,
				0.111345,
				0.207125,
				-0.217432,
				-0.0354095,
				-0.0305453,
				-0.107682,
				0.205703,
				-0.200788,
				0.280795,
				0.178631,
				-0.303868,
				-0.0362043,
				0.12076,
				-0.0049704,
				-0.0151282,
				0.320059,
				-0.0769528,
				-0.385639,
				0.383413,
				0.15716,
				-0.328643,
				0.303512,
				-0.384552,
				-0.104702,
				-0.0177242,
				-0.048052,
				0.505877,
				-0.227032,
				0.27489,
				0.398122,
				0.00701849,
				-0.162165,
				-0.336178,
				0.260946,
				0.799939,
				0.138326,
				-0.0804403,
				0.0325284,
				0.119179,
				0.012899,
				0.1384,
				-0.359204,
				-0.0081218,
				0.0759272,
				-0.334967,
				0.455043,
				-0.359244,
				-0.0468095,
				-0.036913,
				-0.0702889,
				-0.0335874,
				-0.502323,
				-0.264682,
				-5.05549
			};

			defaultModel.assign(model, model + sizeof(model) / sizeof(float));

			break;
		}
		case FULL:
		{
			winSize = cv::Size(64, 128);
			searchRoiRatio = 1.4;
			defaultModel = cv::HOGDescriptor::getDefaultPeopleDetector();
			break;
		}
	}

	svmDetector = defaultModel;
}

std::vector<float> HOGDetector::getDefaultModel()
{
	return defaultModel;
}

double HOGDetector::getSearchRoiRatio()
{
	return searchRoiRatio;
}
